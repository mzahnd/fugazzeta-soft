<!DOCTYPE html>
<html lang="en" dir="ltr">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=yes">
    <title>First Note - Fugazzeta Soft</title>
    <link rel="stylesheet" href="../css/note.css">

    <link rel="stylesheet" href="../css/header.css">
    <link rel="stylesheet" href="../css/footer.css">

    <script>
        function toggleMenu() {
            const btn = document.getElementById("toggle_menu_btn");
            
            const container = document.getElementById("main_menu_container");
            const container_style = window.getComputedStyle(container);
            
            if (!container_style.getPropertyValue('display').localeCompare("none")) {
                container.style.display = "inline-block";
            } else {
                container.style.display = "none";
            }
        }

        function closeMenuOnPageClick() {
            const container = document.getElementById("main_menu_container");
            const container_computed_style = window.getComputedStyle(container);

            if (container.style.getPropertyValue('display').localeCompare("none") || container_style.getPropertyValue('display').localeCompare("none")) {
                container.style.display = "none";
            }
        }
    </script>
  </head>
  <body>
    <div class="page-container">
      <header>
        <div class="header_main">
          <button class="header_main_btn" id="toggle_menu_btn" 
                    onclick="toggleMenu()">M</button>
          <div class="header_main_separator"></div>
          <div class="header_main_logo">
            <a href="../index.html">
                <p>Fugazzeta Soft</p>
                <img class="logo" src="../../res/logo.png"
                        alt="Fugazzeta Soft">
            </a>
          </div>
          <div class="header_main_separator"></div>
        </div>
      </header>

      <div class="menu_container" id="main_menu_container">
          <p>Hi!</p>
      </div>

      <div class="content-padding note-content" onclick="closeMenuOnPageClick()">
        <h1>Installing HP LaserJet 1020</h1>
        <h2>Dependencies</h2>
        <div class="code">
            ]# pacman -S mlocate cups cups-pdf pyqt5 sane
            <br>
            ]# systemctl enable org.cups.cupsd.service
            <br>
            ]# systemctl start org.cups.cupsd.service
            <br>
            ]$ yay -S python-pyqt4 hplip-plugin
            <br>
            ]# sudo updatedb # Update mlocate db.
        </div>

        <p>Even if you have already installed CUPS, restart the service to make
            sure that <b>it is</b> running.
        </p>
        <div class="code">
            ]# systemctl restart org.cups.cupsd.service
        </div>

        <h2> Fixing missing .so files</h2>
        <p>Run hp-setup and log its stderr to a file.</p>
        <p>Be aware that after choosing the printer, the "missing pluggin" o
            any other screen might not be seen when doing this.</p>
        <div class="code">
            ]$ hp-setup -g &> ~/hp-setup.log
            <br>
            ]$ cat ~/hp-setup.log
        </div>

        <p>When openning the file, you'll se something like:</p>
        <div class="code">
        hp-setup[19265]: debug: Either
        /usr/lib/i386-linux-gnu/sane/libsane-hp2000S1.so file is not present or
        symbolic link is missing
        </div>

        <p>You have to locate where is the .so file</p>
        <div class="code">
        ]$ locate libsane-hp2000S1
        </div>

        <p>And create a link to it (if you're having trouble creating the link,
            make sure that the destination folder exists with
            <span class="inline-code">mkdir -p /usr/lib/i386-linux-gnu/sane/
            </span>, for example).</p>
        <div class="code">
        ]# ln -s /usr/lib/sane/libsane-hp2000S1.so 
        /usr/lib/i386-linux-gnu/sane/libsane-hp2000S1.so
        </div>
        <p>After having done this with all the files and getting no more errors
            when opening hp-setup, continue to the next step.</p>

        <h2>Downloading hp-plugin</h2>

        <p>Apparently, the MIT server has some trouble retrieving the key, so
            we will change the line 45 on <span class="inline-code">
            /usr/share/hplip/base/validation.py</span> from <span
            class="inline-code">pgp.mit.edu</span> to <span
            class="inline-code">keyserver.ubuntu.com</span>.</p>

        <p>After that, run the plugin utility, download it and install it.</p>
        <div class="code">
        ]$ hp-plugin -i
        </div> 

        <h2>Checking that there are no missing dependencies.</h2>
        <p>Run</p>
        <div class="code">
        ]$ hp-doctor
        </div>
        <p>And read its output to verify if any dependency marked as <em>
            REQUIRED</em> is missed. If so, install <a href="https://www.google.com">this link</a> it.</p>

        <h2>Final step</h2>
        <p>Run</p>
        <div class="code">
        ]$ hp-setup
        </div>
        <p>:)</p>

        <h2>Sources</h2>
        <a href="https://bugs.launchpad.net/hplip/+bug/1818629">HPLIP 3.19.1 - hp-plugin won't install/update - unable to receive keys</a>
        <br>
        <a href="https://bugs.launchpad.net/hplip/+bug/1084062">No PPD found for model deskjet_4620 using new/old algorithm</a>
      </div>

      <footer>
        <div class="footer footer_main">
          <p>Created by Mart√≠n E. Zahnd</p>
        </div>
      </footer>
    </div>
  </body>
</html>
